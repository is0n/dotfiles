#!/usr/bin/env bash

# Colors
c0="[30m"
c1="[31m"
c2="[32m"
c3="[33m"
c4="[34m"
c5="[35m"
c6="[36m"
c7="[37m"

# Components
OS__="$(grep -oP '^NAME="\K[^"]+' /etc/os-release)"
WM__="$(wmctrl -m | awk '/Name/ { print $2 }')"
SH__="${SHELL##*/}"
TERM="$(ps -o comm= -p "$(($(ps -o ppid= -p "$(($(ps -o sid= -p "$$")))")))")"
PKGS="$(pacman -Q | wc -l) (pacman)"
UP__="$(uptime -p | sed -e 's/up //;s/ day/d/;s/ hours/h/;s/ minutes/m/')"
BTNS="ÔÅñ ÔÅï ÔÅó"
LINE="‚îÄ"

COMPONENTS=( "$OS__" "$WM__" "$SH__" "$TERM" "$PKGS" "$UP__" )

LENGTH=0
for COMPONENT in "${COMPONENTS[@]}"; do
  if [ ${#COMPONENT} -ge $LENGTH ]; then
    LENGTH=${#COMPONENT}
  fi
done

DIFF=$(( $LENGTH - ${#LINE}))
for i in $(seq $DIFF); do
  LINE+="‚îÄ"
done
LINE=${LINE:5}

DIFF=$(( $LENGTH - ${#BTNS}))
PADDING=""
for i in $(seq $DIFF); do
  PADDING+=" "
done

BTNS="$PADDING$BTNS"
BTNS=`sed "s|ÔÅñ|${c3}ÔÅñ|" <<< "$BTNS"`
BTNS=`sed "s|ÔÅï|${c2}ÔÅï|" <<< "$BTNS"`
BTNS=`sed "s|ÔÅó|${c1}ÔÅó|" <<< "$BTNS"`
BTNS=`sed "s|\$|${c7}|" <<< "$BTNS"`

NEW_COMPONENTS=()
for COMPONENT in "${COMPONENTS[@]}"; do
  if [ ${#COMPONENT} -le $LENGTH ]; then
    DIFF=$(( $LENGTH - ${#COMPONENT}))

    for i in $(seq $DIFF); do
      COMPONENT+=" "
    done

    NEW_COMPONENTS+=( "$COMPONENT" )
  fi
done

OS__="${c7}${NEW_COMPONENTS[0]}"
WM__="${c7}${NEW_COMPONENTS[1]}"
SH__="${c7}${NEW_COMPONENTS[2]}"
TERM="${c7}${NEW_COMPONENTS[3]}"
PKGS="${c7}${NEW_COMPONENTS[4]}"
UP__="${c7}${NEW_COMPONENTS[5]}"
CHAR="ÔÜí"

# Fetch
cat << EOF
[1m
${c6}         .         ${c7} ‚ï≠‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ${LINE}‚îÄ‚ïÆ
${c6}        / \        ${c7} ‚îÇ ${c1}Óûô   ${BTNS} ‚îÇ ${c1} ${CHAR}
${c6}       /   \       ${c7} ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ${LINE}‚îÄ‚îÇ ${c2} ${CHAR}
${c6}      /\    \      ${c7} ‚îÇ ${c2}ÔåÉ : ${OS__} ‚îÇ ${c3} ${CHAR}
${c6}     /       \     ${c7} ‚îÇ ${c3}Ôíà : ${WM__} ‚îÇ ${c4} ${CHAR}
${c6}    /   .-.   \    ${c7} ‚îÇ ${c4}Ôíâ : ${SH__} ‚îÇ ${c5} ${CHAR}
${c6}   /   (   )  -\   ${c7} ‚îÇ ${c5}Óûï : ${TERM} ‚îÇ ${c6} ${CHAR}
${c6}  / -.~     ~.- \  ${c7} ‚îÇ ${c6}ÔÖ´ : ${PKGS} ‚îÇ ${c7} ${CHAR}
${c6} /.^           ^.\ ${c7} ‚ï∞‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ${LINE}‚îÄ‚ïØ
[0m
EOF


# Dead simple fetch :(
# ${c6}        .        ${c7} ‚ï≠‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ïÆ
# ${c6}       / \       ${c1}   Óûô ${c7}: ${OS__}
# ${c6}      /   \      ${c2}   Ôíà ${c7}: ${WM__}
# ${c6}     /     \     ${c3}   Ôíâ ${c7}: ${SH__}
# ${c6}    /  .-.  \    ${c4}   Óûï ${c7}: ${TERM}
# ${c6}   /  (   )  \   ${c5}   ÔÖ´ ${c7}: ${PKGS}
# ${c6}  / -.~   ~.- \  ${c7} ‚ï∞‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ïØ
# ${c6} /.^         ^.\ ${c7}   ${c1}ÔÜí  ${c2}ÔÜí  ${c3}ÔÜí  ${c4}ÔÜí  ${c5}ÔÜí  ${c6}ÔÜí  ${c7}ÔÜí
